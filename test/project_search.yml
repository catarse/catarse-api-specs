---
- config:
  - testset: "/rpc/project_search"

- test:
  - name: "Keyword search"
  - url: "/rpc/project_search"
  - method: "POST"
  - headers: {'Content-Type': 'application/json'}
  - body: '{"query": "tudo"}'
  - validators:
    - compare: {jsonpath_mini: '0.permalink', comparator: 'str_eq', expected: 'tudo_ou_nada'}
    - compare: {jsonpath_mini: "1.permalink", comparator: "str_eq", expected: 'tudo_ou_nada_successful_account_error'}
    - compare: {jsonpath_mini: "2.permalink", comparator: "str_eq", expected: 'tudo_ou_nada_successful'}
    - compare: {jsonpath_mini: "3.permalink", comparator: "str_eq", expected: 'None'}

- test:
  - name: "Trigram search"
  - url: "/rpc/project_search"
  - method: "POST"
  - headers: {'Content-Type': 'application/json'}
  - body: '{"query": "projto&flexivl"}'
  - validators:
    - compare: {jsonpath_mini: '0.permalink', comparator: 'str_eq', expected: 'flexivel'}
    - compare: {jsonpath_mini: "1.permalink", comparator: "str_eq", expected: None}
